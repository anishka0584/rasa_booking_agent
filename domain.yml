version: "3.1"

intents:
  - greet
  - book_hotel
  - inform
  - goodbye
  - out_of_scope

entities:
  - city
  - check_in_date
  - check_out_date
  - number_of_guests

slots:
  city:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: city
      - type: from_text
        conditions:
          - active_loop: hotel_booking_form
            requested_slot: city

  check_in_date:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        conditions:
          - active_loop: hotel_booking_form
            requested_slot: check_in_date

  check_out_date:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        conditions:
          - active_loop: hotel_booking_form
            requested_slot: check_out_date

  number_of_guests:
    type: float
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: number_of_guests
        #this condition only fills the number of guests if the form is active- not direct extraction from the initial message
        # conditions:
        # - active_loop: hotel_booking_form
        #   requested_slot: number_of_guests
      - type: from_text
        conditions:
          - active_loop: hotel_booking_form
            requested_slot: number_of_guests

  initial_message:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        conditions:
          - active_loop: null
          
responses:
  utter_greet:
    - text: "Hello ðŸ‘‹ How can I help you today?"

  utter_ask_city:
    - text: "Which city are you traveling to?"

  utter_ask_check_in_date:
    - text: "What is your check-in date?"

  utter_ask_check_out_date:
    - text: "What is your check-out date?"

  utter_ask_number_of_guests:
    - text: "How many guests will be staying?"

  utter_booking_confirmation:
    - text: |
        âœ… Your hotel in {city} from {check_in_date} to {check_out_date}
        for {number_of_guests} guests has been booked!

  utter_goodbye:
    - text: "Goodbye ðŸ‘‹ Have a great day!"

  utter_out_of_scope: 
    - text: "I didn't understand that. Please provide the requested information."


forms:
  hotel_booking_form:
    ignored_intents:
      - greet
      - goodbye
      - out_of_scope
    required_slots:
      - city
      - check_in_date
      - check_out_date
      - number_of_guests

actions:
  - validate_hotel_booking_form
  - action_store_initial_message
